pipeline {
    agent any
    
    stages {
        stage('Checkout') {
            steps {
                // Checkout code from GitHub repository
                git 'https://github.com/santhoshbabu0411/springbootdemo.git'
            }
        }
        
        stage('Check Maven') {
            steps {
                script {
                    // Check if Maven is already installed
                    def mavenHome = tool 'Maven'
                    if (mavenHome == null) {
                        echo "Maven is not installed, installing now..."
                        // Install Maven tool using the Maven installer tool name
                        env.MAVEN_HOME = tool 'Maven'
                        // Add Maven bin directory to PATH
                        env.PATH += "${env.MAVEN_HOME}/bin"
                    } else {
                        echo "Maven is already installed at: $mavenHome"
                        // Set MAVEN_HOME environment variable
                        env.MAVEN_HOME = mavenHome
                        // Add Maven bin directory to PATH if needed
                        if (!env.PATH.contains("${env.MAVEN_HOME}/bin")) {
                            env.PATH += "${env.MAVEN_HOME}/bin"
                        }
                    }
                }
            }
        }
        
        stage('Build') {
            steps {
                // Build the project using Maven
                sh 'mvn clean install'
            }
        }
    }
}

